<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Trox – الفضاء الواسع والكبسولات</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: "Cairo", sans-serif;
    background: radial-gradient(ellipse at center, #000010 0%, #000015 100%);
    color: #fff;
  }
  canvas { display: block; }
  .tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    padding: 8px 12px;
    border-radius: 8px;
    pointer-events: none;
    font-size: 0.9rem;
    max-width: 200px;
    display: none;
  }
</style>
</head>
<body>
<canvas id="space"></canvas>
<div id="tooltip" class="tooltip"></div>
<script>
const canvas = document.getElementById('space');
const ctx = canvas.getContext('2d');
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

window.addEventListener('resize', ()=>{
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});

// نجوم
const stars = [];
for(let i=0;i<150;i++){
  stars.push({
    x: Math.random()*width,
    y: Math.random()*height,
    size: Math.random()*2+1,
    opacity: Math.random()*0.8+0.2
  });
}

// كبسولات عشوائية
const ranks = ["common","special","legend"];
const capsules = [];
for(let i=0;i<50;i++){
  capsules.push({
    x: Math.random()*2000-1000,
    y: Math.random()*2000-1000,
    title: "كبسولة "+(i+1),
    message: "رسالة عشوائية "+(i+1),
    rank: ranks[Math.floor(Math.random()*ranks.length)],
    size: 8 + Math.random()*4
  });
}

// متغيرات التمرير
let offsetX = 0, offsetY = 0;
let isDragging = false;
let dragStart = {};

canvas.addEventListener('mousedown', e=>{
  isDragging=true;
  dragStart={x:e.clientX-offsetX, y:e.clientY-offsetY};
});
canvas.addEventListener('mouseup', ()=>{ isDragging=false; });
canvas.addEventListener('mousemove', e=>{
  if(isDragging){
    offsetX = e.clientX - dragStart.x;
    offsetY = e.clientY - dragStart.y;
  }
  // tooltip hover
  const tooltip = document.getElementById('tooltip');
  let found=false;
  capsules.forEach(c=>{
    const dx = e.clientX - (c.x+offsetX+width/2);
    const dy = e.clientY - (c.y+offsetY+height/2);
    if(Math.sqrt(dx*dx+dy*dy)<c.size+4){
      tooltip.style.display='block';
      tooltip.style.left=(e.clientX+12)+'px';
      tooltip.style.top=(e.clientY+12)+'px';
      tooltip.innerHTML=`<strong>${c.title}</strong><br>${c.message}<br><em>${c.rank}</em>`;
      found=true;
    }
  });
  if(!found) tooltip.style.display='none';
});

// رسم الفضاء
function draw(){
  ctx.clearRect(0,0,width,height);
  // نجوم
  stars.forEach(s=>{
    ctx.fillStyle = `rgba(255,255,255,${s.opacity})`;
    ctx.beginPath();
    ctx.arc(s.x+offsetX, s.y+offsetY, s.size,0,Math.PI*2);
    ctx.fill();
  });
  // كبسولات
  capsules.forEach(c=>{
    let color="#00ccff";
    if(c.rank==="special") color="#ffcc00";
    if(c.rank==="legend") color="#ff4444";
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(c.x+offsetX+width/2, c.y+offsetY+height/2, c.size,0,Math.PI*2);
    ctx.fill();
  });
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
