<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trox â€“ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© Ø§Ù„Ø®Ø§Ù„Ø¯Ø©</title>
  <style>
    :root{
      --accent: #00ccff;
      --bg1: #000010;
      --bg2: #0b1020;
    }
    *{box-sizing:border-box;}
    html,body{height:100%;margin:0;font-family:"Cairo",sans-serif;background:radial-gradient(ellipse at center,var(--bg1) 0%,var(--bg2) 100%);color:#fff;}
    .wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:28px;}
    header{max-width:920px;text-align:center;padding:24px;}
    h1{color:var(--accent);font-size:2.4rem;margin:0 0 8px;}
    p.lead{color:#cfd6e0;max-width:700px;margin:0 auto 18px;line-height:1.5;}
    .btn {background:var(--accent);color:#000;padding:10px 20px;border-radius:999px;text-decoration:none;font-weight:700;display:inline-block;cursor:pointer;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:12px;padding:18px;backdrop-filter: blur(6px);box-shadow:0 6px 22px rgba(0,0,0,0.6);width:100%;max-width:720px;margin-top:20px;}
    label{display:block;margin:8px 0 6px;font-size:0.95rem;color:#dbe6f0;}
    input[type="text"], textarea {width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1rem;}
    textarea{min-height:100px;resize:vertical;}
    .capsules{margin-top:18px;display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;}
    .capsule{padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);}
    .capsule h4{margin:0 0 6px;color:var(--accent);}
    .small{font-size:0.85rem;color:#9fb0c7;}
    .empty{opacity:0.6;text-align:center;padding:18px;}
    footer{opacity:0.6;margin-top:28px;font-size:0.85rem;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>âš¡ Trox â€“ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© Ø§Ù„Ø®Ø§Ù„Ø¯Ø© âš¡</h1>
      <p class="lead">Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©ØŒ Ø§Ø­ÙØ¸Ù‡Ø§ ÙƒØ¨Ø³ÙˆÙ„Ø© Ø±Ù‚Ù…ÙŠØ©ØŒ ÙˆØ´Ø§Ø±Ùƒ Ù„Ø­Ø¸Ø© Ø®Ø§Ù„Ø¯Ø© Ù…Ø¹ Ø§Ù„Ø¹Ø§Ù„Ù….</p>
    </header>

    <section class="card" id="form">
      <label>Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input id="name" type="text" placeholder="Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ù„Ù‚Ø¨Ùƒ">

      <label>Ø¹Ù†ÙˆØ§Ù† Ù„Ù„ÙƒØ¨Ø³ÙˆÙ„Ø©</label>
      <input id="title" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø±Ø³Ø§Ù„Ø© Ù„Ø§Ø¨Ù†ÙŠ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„">

      <label>Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...</label>
      <textarea id="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."></textarea>

      <button id="saveBtn" class="btn">Ø§Ø­ÙØ¸ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© ğŸš€</button>
    </section>

    <section class="card" id="list">
      <h3>ÙƒØ¨Ø³ÙˆÙ„Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</h3>
      <div id="capsulesContainer" class="capsules"></div>
      <div id="emptyMsg" class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØ¨Ø³ÙˆÙ„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</div>
    </section>

    <footer>Ù…Ø´Ø±ÙˆØ¹ ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ù† <strong>Odae Waked</strong> Â© 2025</footer>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

    // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCR8AiukqMEGOFDsjhv7tsFFFLDM5gWpu4",
      authDomain: "trox-capsules.firebaseapp.com",
      projectId: "trox-capsules",
      storageBucket: "trox-capsules.appspot.com",
      messagingSenderId: "104606988275",
      appId: "1:104606988275:web:24d2a719dd863357660486",
      measurementId: "G-MEKWLRWGDS"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
    const saveBtn = document.getElementById('saveBtn');
    const nameInput = document.getElementById('name');
    const titleInput = document.getElementById('title');
    const messageInput = document.getElementById('message');
    const capsulesContainer = document.getElementById('capsulesContainer');
    const emptyMsg = document.getElementById('emptyMsg');

    // Ø­ÙØ¸ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø©
    saveBtn.addEventListener('click', async () => {
      const name = nameInput.value.trim();
      const title = titleInput.value.trim();
      const message = messageInput.value.trim();
      if (!message) { alert("Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸!"); return; }

      try {
        await addDoc(collection(db, "capsules"), { name, title, message, ts: Date.now() });
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        nameInput.value = '';
        titleInput.value = '';
        messageInput.value = '';
        loadCapsules();
      } catch(e) {
        console.error(e);
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¹Ù†Ø¯ Ø§Ù„Ø­ÙØ¸");
      }
    });

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø§Øª
    async function loadCapsules() {
      const q = query(collection(db, "capsules"), orderBy("ts", "desc"));
      const snapshot = await getDocs(q);
      capsulesContainer.innerHTML = '';
      if (snapshot.empty) {
        emptyMsg.style.display = "block";
        return;
      }
      emptyMsg.style.display = "none";
      snapshot.forEach(doc => {
        const data = doc.data();
        const el = document.createElement('div');
        el.className = "capsule";
        el.innerHTML = `<h4>${data.title || 'ÙƒØ¨Ø³ÙˆÙ„Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</h4>
                        <div class="small">Ø§Ù„Ù…Ø±Ø³Ù„: ${data.name || 'Ù…Ø¬Ù‡ÙˆÙ„'}</div>
                        <p>${data.message}</p>`;
        capsulesContainer.appendChild(el);
      });
    }

    // ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ Ù„Ù„ÙƒØ¨Ø³ÙˆÙ„Ø§Øª
    loadCapsules();
  </script>
</body>
</html>
